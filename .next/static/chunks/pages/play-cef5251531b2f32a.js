(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[141],{2852:function(e,t,r){"use strict";var a=r(3366),i=r(7462),n=r(7294),o=r(512),s=r(8510),l=r(2101),c=r(8216),d=r(1964),u=r(8114),h=r(948),m=r(9632),p=r(5893);let g=["className","color","edge","size","sx"],v=(0,u.U)("MuiSwitch"),useUtilityClasses=e=>{let{classes:t,edge:r,size:a,color:n,checked:o,disabled:l}=e,d={root:["root",r&&`edge${(0,c.Z)(r)}`,`size${(0,c.Z)(a)}`],switchBase:["switchBase",`color${(0,c.Z)(n)}`,o&&"checked",l&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},u=(0,s.Z)(d,m.H,t);return(0,i.Z)({},t,u)},f=(0,h.ZP)("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,r.edge&&t[`edge${(0,c.Z)(r.edge)}`],t[`size${(0,c.Z)(r.size)}`]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${m.Z.thumb}`]:{width:16,height:16},[`& .${m.Z.switchBase}`]:{padding:4,[`&.${m.Z.checked}`]:{transform:"translateX(16px)"}}}}]}),x=(0,h.ZP)(d.Z,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.switchBase,{[`& .${m.Z.input}`]:t.input},"default"!==r.color&&t[`color${(0,c.Z)(r.color)}`]]}})(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${"light"===e.palette.mode?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${m.Z.checked}`]:{transform:"translateX(20px)"},[`&.${m.Z.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${"light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${m.Z.checked} + .${m.Z.track}`]:{opacity:.5},[`&.${m.Z.disabled} + .${m.Z.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${"light"===e.palette.mode?.12:.2}`},[`& .${m.Z.input}`]:{left:"-100%",width:"300%"}}),({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,l.Fq)(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(([,e])=>e.main&&e.light).map(([t])=>({props:{color:t},style:{[`&.${m.Z.checked}`]:{color:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,l.Fq)(e.palette[t].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${m.Z.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t}DisabledColor`]:`${"light"===e.palette.mode?(0,l.$n)(e.palette[t].main,.62):(0,l._j)(e.palette[t].main,.55)}`}},[`&.${m.Z.checked} + .${m.Z.track}`]:{backgroundColor:(e.vars||e).palette[t].main}}}))]})),Z=(0,h.ZP)("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(({theme:e})=>({height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${"light"===e.palette.mode?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${"light"===e.palette.mode?.38:.3}`})),w=(0,h.ZP)("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),y=n.forwardRef(function(e,t){let r=v({props:e,name:"MuiSwitch"}),{className:n,color:s="primary",edge:l=!1,size:c="medium",sx:d}=r,u=(0,a.Z)(r,g),h=(0,i.Z)({},r,{color:s,edge:l,size:c}),m=useUtilityClasses(h),y=(0,p.jsx)(w,{className:m.thumb,ownerState:h});return(0,p.jsxs)(f,{className:(0,o.Z)(m.root,n),sx:d,ownerState:h,children:[(0,p.jsx)(x,(0,i.Z)({type:"checkbox",icon:y,checkedIcon:y,ref:t,ownerState:h},u,{classes:(0,i.Z)({},m,{root:m.switchBase})})),(0,p.jsx)(Z,{className:m.track,ownerState:h})]})});t.Z=y},9632:function(e,t,r){"use strict";r.d(t,{H:function(){return getSwitchUtilityClass}});var a=r(1977),i=r(8027);function getSwitchUtilityClass(e){return(0,i.ZP)("MuiSwitch",e)}let n=(0,a.Z)("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]);t.Z=n},7454:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/play",function(){return r(4757)}])},4757:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Play}});var a=r(5893),i=r(8583),n=r(9983),o=r(6167),s=r(5103);let l=(0,s.cn)(new o.qQ),c=(0,s.cn)({}),d=(0,s.cn)(n.Il.White),u=(0,s.cn)(n.g_.Stockfish16),h=(0,s.cn)(1),m=(0,s.cn)(!1);var p=r(8951),g=r(7294),v=r(7853),f=r(9758),x=r(5366),Z=r(7279);let useGameData=(e,t)=>{let r=(0,i.Dv)(e),[a,n]=(0,i.KO)(t);return(0,g.useEffect)(()=>{let e=r.history({verbose:!0}),t=e.at(-1);n({lastMove:t})},[r]),a};function BoardContainer(){let e=(0,v.e)(),t=(0,i.Dv)(u),r=(0,f.E)(t),o=(0,i.Dv)(l),s=(0,i.Dv)(d),{makeMove:w}=(0,p.f)(l),y=(0,i.Dv)(h),k=(0,i.Dv)(m),b=o.fen(),j=o.isGameOver();(0,g.useEffect)(()=>{let playEngineMove=async()=>{if(!(null==r?void 0:r.isReady())||o.turn()===s||j||!k)return;let e=await r.getEngineNextMove(b,y-1);e&&w((0,x.FB)(e))};return playEngineMove(),()=>{null==r||r.stopSearch()}},[b,k]);let S=(0,g.useMemo)(()=>{var t;let r=e.width,a=e.height;return(null===(t=window)||void 0===t?void 0:t.innerWidth)<900?Math.min(r,a-150):Math.min(r-300,.85*a)},[e]);return useGameData(l,c),(0,a.jsx)(Z.Z,{id:"PlayBoard",canPlay:!!k&&s,gameAtom:l,boardSize:S,whitePlayer:s===n.Il.White?"You \uD83E\uDDE0":"Stockfish level ".concat(y," \uD83E\uDD16"),blackPlayer:s===n.Il.Black?"You \uD83E\uDDE0":"Stockfish level ".concat(y," \uD83E\uDD16"),boardOrientation:s,currentPositionAtom:c})}var w=r(6886),y=r(5861),k=r(8456),b=r(5662),j=r(1251);function UndoMoveButton(){let e=(0,i.Dv)(l),{goToMove:t,undoMove:r}=(0,p.f)(l),o=(0,i.Dv)(d);return(0,a.jsx)(b.Z,{variant:"outlined",onClick:()=>{let a=e.history(),i=e.turn();if("w"===i&&o===n.Il.White||"b"===i&&o===n.Il.Black){if(a.length<2)return;t(a.length-2,e)}else{if(!a.length)return;r()}},children:"Undo your last move"})}function GameInProgress(){let e=(0,i.Dv)(l),[t,r]=(0,i.KO)(m);return((0,g.useEffect)(()=>{e.isGameOver()&&r(!1)},[e,r]),t)?(0,a.jsxs)(w.ZP,{item:!0,container:!0,xs:12,justifyContent:"center",alignItems:"center",gap:2,children:[(0,a.jsxs)(w.ZP,{container:!0,item:!0,justifyContent:"center",alignItems:"center",xs:12,gap:2,children:[(0,a.jsx)(y.Z,{children:"Game in progress"}),(0,a.jsx)(k.Z,{size:20,color:"info"})]}),(0,a.jsx)(w.ZP,{item:!0,container:!0,justifyContent:"center",alignItems:"center",xs:12,children:(0,a.jsx)(UndoMoveButton,{})}),(0,a.jsx)(w.ZP,{item:!0,container:!0,justifyContent:"center",alignItems:"center",xs:12,children:(0,a.jsx)(b.Z,{variant:"outlined",onClick:()=>{(0,j.QA)(),r(!1)},children:"Resign"})})]}):null}var S=r(7697),C=r(1163);function GameRecap(){let e=(0,i.Dv)(l),t=(0,i.Dv)(d),r=(0,i.Dv)(m),{addGame:o}=(0,S.f)(),s=(0,C.useRouter)();if(r||!e.history().length)return null;let handleOpenGameAnalysis=async()=>{let r=(0,x.jT)(e,{resigned:e.isGameOver()?void 0:t}),a=await o(r);s.push({pathname:"/",query:{gameId:a}})};return(0,a.jsxs)(w.ZP,{item:!0,container:!0,xs:12,justifyContent:"center",alignItems:"center",gap:2,children:[(0,a.jsx)(w.ZP,{item:!0,container:!0,xs:12,justifyContent:"center",children:(0,a.jsx)(y.Z,{children:(()=>{if(e.isCheckmate()){let r="w"===e.turn()?n.Il.Black:n.Il.White;return"".concat(r===t?"You":"Stockfish"," won by checkmate !")}return e.isInsufficientMaterial()?"Draw by insufficient material":e.isStalemate()?"Draw by stalemate":e.isThreefoldRepetition()?"Draw by threefold repetition":(e.isDraw(),"You resigned")})()})}),(0,a.jsx)(b.Z,{variant:"outlined",onClick:handleOpenGameAnalysis,children:"Open game analysis"})]})}var D=r(7539),$=r(657),I=r(7645),P=r(6514),B=r(4054),E=r(3841),M=r(5945),G=r(7709),R=r(8972),_=r(3366),O=r(7462),N=r(512),W=r(8510),z=r(948),U=r(1657),F=r(1977),Y=r(8027);function getFormGroupUtilityClass(e){return(0,Y.ZP)("MuiFormGroup",e)}(0,F.Z)("MuiFormGroup",["root","row","error"]);var T=r(4423),A=r(5704);let q=["className","row"],useUtilityClasses=e=>{let{classes:t,row:r,error:a}=e;return(0,W.Z)({root:["root",r&&"row",a&&"error"]},getFormGroupUtilityClass,t)},H=(0,z.ZP)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,r.row&&t.row]}})(({ownerState:e})=>(0,O.Z)({display:"flex",flexDirection:"column",flexWrap:"wrap"},e.row&&{flexDirection:"row"})),K=g.forwardRef(function(e,t){let r=(0,U.Z)({props:e,name:"MuiFormGroup"}),{className:i,row:n=!1}=r,o=(0,_.Z)(r,q),s=(0,T.Z)(),l=(0,A.Z)({props:r,muiFormControl:s,states:["error"]}),c=(0,O.Z)({},r,{row:n,error:l.error}),d=useUtilityClasses(c);return(0,a.jsx)(H,(0,O.Z)({className:(0,N.Z)(d.root,i),ownerState:c,ref:t},o))});var X=r(6836),L=r(2852),Q=r(1425),V=r(2939),J=r(9232);function GameSettingsDialog(e){let{open:t,onClose:r}=e,[o,s]=(0,V.Y)("engine-skill-level",h),[c,v]=(0,V.Y)("engine-play-name",u),[f,x]=(0,i.KO)(d),Z=(0,i.b9)(m),{reset:k}=(0,p.f)(l);return(0,g.useEffect)(()=>{J.E.isSupported()||v(n.g_.Stockfish11)},[v]),(0,a.jsxs)($.Z,{open:t,onClose:r,maxWidth:"md",fullWidth:!0,children:[(0,a.jsx)(I.Z,{marginY:1,variant:"h5",children:"Set game parameters"}),(0,a.jsxs)(P.Z,{sx:{paddingBottom:0},children:[(0,a.jsx)(y.Z,{children:"Stockfish 16 Lite (HCE) is the default engine. It offers the best balance between speed and strength. Stockfish 16 is the strongest engine available, but please note that it requires a one time download of 40MB."}),(0,a.jsxs)(w.ZP,{marginTop:4,item:!0,container:!0,justifyContent:"center",alignItems:"center",xs:12,rowGap:3,children:[(0,a.jsx)(w.ZP,{item:!0,container:!0,xs:12,justifyContent:"center",children:(0,a.jsxs)(B.Z,{variant:"outlined",children:[(0,a.jsx)(E.Z,{id:"dialog-select-label",children:"Bot's engine"}),(0,a.jsx)(M.Z,{labelId:"dialog-select-label",id:"dialog-select",displayEmpty:!0,input:(0,a.jsx)(G.Z,{label:"Engine"}),value:c,onChange:e=>v(e.target.value),sx:{width:280,maxWidth:"100%"},children:Object.values(n.g_).map(e=>(0,a.jsx)(R.Z,{value:e,disabled:!!e.includes("stockfish_16")&&!J.E.isSupported(),children:ee[e]},e))})]})}),(0,a.jsx)(D.Z,{label:"Bot skill level",value:o,setValue:s,min:1,max:21,marksFilter:2}),(0,a.jsx)(K,{children:(0,a.jsx)(X.Z,{control:(0,a.jsx)(L.Z,{color:"default",checked:f===n.Il.White,onChange:e=>{x(e.target.checked?n.Il.White:n.Il.Black)}}),label:f===n.Il.White?"You play as White":"You play as Black"})})]})]}),(0,a.jsxs)(Q.Z,{sx:{m:2},children:[(0,a.jsx)(b.Z,{variant:"outlined",sx:{marginRight:2},onClick:r,children:"Cancel"}),(0,a.jsx)(b.Z,{variant:"contained",onClick:()=>{r(),k({whiteName:f===n.Il.White?"You":"Stockfish level ".concat(o),blackName:f===n.Il.Black?"You":"Stockfish level ".concat(o)}),(0,j.K3)(),Z(!0)},children:"Start game"})]})]})}let ee={[n.g_.Stockfish16]:"Stockfish 16 Lite (HCE)",[n.g_.Stockfish16NNUE]:"Stockfish 16 (40MB download)",[n.g_.Stockfish11]:"Stockfish 11"};function GameSettingsButton(){let[e,t]=(0,g.useState)(!1),r=(0,i.Dv)(l);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{variant:"contained",onClick:()=>t(!0),children:r.history().length?"Start new game":"Start game"}),(0,a.jsx)(GameSettingsDialog,{open:e,onClose:()=>t(!1)})]})}function Play(){let e=(0,i.Dv)(m);return(0,a.jsxs)(w.ZP,{container:!0,gap:4,justifyContent:"space-evenly",alignItems:"start",children:[(0,a.jsx)(BoardContainer,{}),(0,a.jsxs)(w.ZP,{container:!0,item:!0,marginTop:{xs:0,md:"2.5em"},justifyContent:"center",alignItems:"center",borderRadius:2,border:1,borderColor:"secondary.main",xs:12,md:!0,sx:{backgroundColor:"secondary.main",borderColor:"primary.main",borderWidth:2,boxShadow:"0 2px 10px rgba(0, 0, 0, 0.5)"},padding:3,rowGap:3,style:{maxWidth:"400px"},children:[(0,a.jsx)(GameInProgress,{}),!e&&(0,a.jsx)(GameSettingsButton,{}),(0,a.jsx)(GameRecap,{})]})]})}}},function(e){e.O(0,[546,982,76,381,774,888,179],function(){return e(e.s=7454)}),_N_E=e.O()}]);